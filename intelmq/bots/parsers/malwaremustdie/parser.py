# -*- coding: utf-8 -*-
"""
MalwaremustdieParserBot parses data from https://malwared.malwaremustdie.org/db/fulllist.php.

"""
from intelmq.lib.bot import ParserBot
from intelmq.lib import utils

class MalwaremustdieParserBot(ParserBot):
    def process(self):
        report = self.receive_message()
        for line in utils.base64_decode(report.get('raw')).split("<br>"):
            if line.startswith('http') and not len(line) == 0:
                event = self.new_event(report)
                event.add('source.url', line)
                event.add('raw', line)
                self.send_message(event)
        self.acknowledge_message()
BOT = MalwaremustdieParserBot